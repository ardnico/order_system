{% extends "base.html" %}
{% block content %}
<h1>Register</h1>
<form method="post" class="card">
    <label>
        Display name
        <input type="text" name="display_name" required>
    </label>
    <label>
        Email
        <input type="email" name="email" required>
    </label>
    <label>
        Password
        <input type="password" name="password" required>
    </label>
    <div class="radio-row">
        <label><input type="radio" name="create_household" value="1" checked> Create household</label>
        <label><input type="radio" name="create_household" value="" > Join existing</label>
    </div>
    <div id="new-household">
        <label>
            Household name
            <input type="text" name="household_name">
        </label>
        <label>
            Join code (optional)
            <input type="text" name="join_code" placeholder="autogenerated if blank">
        </label>
    </div>
    <div id="existing-household" class="hidden">
        <label>
            Select household
            <select name="household_id">
                <option value="">-- choose --</option>
                {% for h in households %}
                <option value="{{ h.id }}">{{ h.name }}</option>
                {% endfor %}
            </select>
        </label>
        <label>
            Join code
            <input type="text" name="join_code" placeholder="enter household join code">
        </label>
    </div>
    <button type="submit">Register</button>
</form>
<p>Already registered? <a href="/login">Login</a></p>
<script>
const createRadio = document.querySelector('input[name="create_household"][value="1"]');
const joinRadio = document.querySelector('input[name="create_household"][value=""]');
const newSection = document.getElementById('new-household');
const existingSection = document.getElementById('existing-household');
function toggleSections() {
    const creating = createRadio.checked;
    newSection.classList.toggle('hidden', !creating);
    existingSection.classList.toggle('hidden', creating);
}
createRadio.addEventListener('change', toggleSections);
joinRadio.addEventListener('change', toggleSections);
toggleSections();
</script>
{% endblock %}
