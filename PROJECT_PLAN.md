# PROJECT_PLAN: 家事ポイント受発注 Web アプリ

## 1. 概要

### 1.1 プロジェクト名（仮）
家事受発注ポイントボード（仮）

### 1.2 コンセプト
- 家の中の「家事」をタスクとして **発注／受注** できる Web アプリ
- タスク完了に応じて **ポイントを付与・蓄積** し、  
  ポイントを使って「ご褒美／特典」を **申請・消費** できる
- 「発注書」に近い形で、内容・期日・条件を明示し、  
  家事分担の取り決めと見える化をする

### 1.3 対象利用者
- 同居している家族（夫婦・カップル・親子など）
- スマホ or PC のブラウザからアクセスできることを前提

---

## 2. ゴール / アンチゴール

### 2.1 ゴール

1. **Web ブラウザから利用可能**
   - スマホ / PC ブラウザでアクセスし、ログインして利用できる
2. **家事タスクの「発注」と「受注」ができる**
   - 発注者が「家事タスク」を登録し、誰かが受注できる形で公開する
   - 受注者が「担当します」と引き受ける
3. **ポイント蓄積・履歴管理**
   - タスク完了時にポイントが付与され、ユーザごとの残高が見える
   - ポイントの付与履歴・消費履歴が参照できる
4. **ポイント用途（ご褒美）の登録と使用**
   - 「〇〇を買う」「〇時間自由時間」など、ポイントの使い道を登録
   - ポイント残高から差し引いて、用途に「使用申請／確定」ができる
5. **発注書に近い情報の管理**
   - 発注内容（タイトル・詳細・条件など）
   - 期日（締切日）
   - 発注日、自動採番された発注番号
   - ポイントの想定値（見積）・実績値
   - 優先度・カテゴリ（掃除、料理、買い物など）
   - 発注者／受注者情報
   - テンプレートから自動入力できる仕組み

### 2.2 アンチゴール（やらないこと）

- 外部決済手段（クレカ決済・銀行連携など）との連携
- 法人向けワークフロー（承認フローを 3 段階以上にするなど）
- モバイルネイティブアプリ（iOS / Android ネイティブ）の実装
- 公開 SaaS としてのユーザ管理・課金機能
- 高度な分析ダッシュボード（グラフ・統計）は MVP では後回し

---

## 3. ユースケース / ペルソナ

### 3.1 ペルソナ例
- ユーザ A：家事を多くやっているが「可視化されない」ことに不満
- ユーザ B：家事を「やってるつもり」だが、実際どれくらい貢献しているか分からない  
→ 両者の負荷感や貢献度を **ポイントという共通通貨** で可視化する

### 3.2 主要ユースケース

1. 発注者が家事タスクを登録する
2. テンプレートから「よくあるタスク」を選んで発注する
3. 受注者がタスク一覧から「受注」する
4. 受注者が実施後、「完了報告」を出す
5. 発注者が「完了承認」し、ポイントが自動付与される
6. 利用者が自分のポイント残高・履歴を確認する
7. 利用者が「ポイント用途（ご褒美）」を登録する
8. 利用者がポイントを使って「用途に申請」し、残高が減る
9. 発注者／パートナーが「ご褒美使用」を確認して承認する（任意）

---

## 4. 機能要件

### 4.1 必須機能（MVP）

#### 4.1.1 認証・ユーザ管理
- 家庭単位の「グループ」と、その中の「ユーザ」
- メール＋パスワード or ローカル簡易ログイン（最小構成でよい）
- ログイン中ユーザの識別

#### 4.1.2 家事発注（タスク登録）

**項目例：**

- 発注番号（自動採番）
- タイトル（例：風呂掃除、買い物：〇〇）
- 詳細説明（Markdown or プレーンテキスト）
- カテゴリ（掃除 / 料理 / 洗濯 / 買い物 / その他）
- 期日（必須）
- 期限時刻（任意）
- 提案ポイント（見積ポイント）
- 優先度（高 / 中 / 低）
- 発注者（ログインユーザ）
- ステータス（発注中 / 受注済み / 作業中 / 完了報告 / 完了承認 / キャンセル）
- 備考（自由記述）

**動作:**

- 新規発注画面から登録
- テンプレート選択時は、一部項目（タイトル・カテゴリ・ポイントなど）を自動埋め

#### 4.1.3 発注テンプレート管理

- よく使うタスクを「テンプレート」として登録・編集・削除
- テンプレートに持たせる情報：
  - タイトル
  - デフォルトカテゴリ
  - デフォルトポイント
  - 期日相対設定（例：今日＋3日、今週中 など）※MVPでは「未設定」でも良い
  - メモ

#### 4.1.4 受注 / 作業ステータス管理

- タスク一覧から「受注」ボタン
  - 受注者が設定され、ステータスが「受注済み」に変化
- 受注者が「作業中に変更」「完了報告」できる
- 発注者が「完了承認」を押すと、ポイントが付与される

#### 4.1.5 ポイント管理

- ポイント付与ルール：
  - 原則「提案ポイント」をそのまま付与
  - 将来的に「難易度で係数を変える」などの余地を残す
- ポイント残高：ユーザ単位で管理
- ポイント履歴：
  - 日付
  - 種別（付与 / 消費）
  - 対象（タスク / ポイント用途）
  - ポイント数
  - 備考

#### 4.1.6 ポイント用途（ご褒美）管理

- ポイント用途テンプレートの登録
  - 用途名（例：ゲーム 1 時間、外食 1 回、ガジェット購入 etc.）
  - 必要ポイント
  - 説明
- ポイント用途の「申請」・「承認」フロー（MVP の簡易版）
  - 申請者が用途を選び、ポイント消費申請
  - 自動承認でもよいが、オプションで「パートナー承認」を付けられるようにする
  - 承認時にポイント残高から差し引き

---

## 5. 非機能要件（ざっくり）

- Web ブラウザで動作（モバイルでの利用を意識）
- 軽量 & シンプル UI（家族がストレスなく使えることが優先）
- 家庭ローカル利用想定（初期は外部公開前提にしない設計でもよい）
- データ永続化：RDB（例：PostgreSQL / SQLite）を想定
- 認証・認可は家庭内利用前提でシンプルに

---

## 6. ドメインモデル（概略）

### 6.1 主なエンティティ

- `User`
  - id
  - name
  - email
  - password_hash
  - household_id（所属グループ）
  - role（admin / member）
  - point_balance

- `Household`（家庭・グループ）
  - id
  - name

- `Task`（家事発注）
  - id
  - household_id
  - title
  - description
  - category
  - status
  - requested_points
  - actual_points
  - priority
  - due_date
  - due_time (nullable)
  - requester_id
  - assignee_id (nullable)
  - created_at
  - updated_at
  - template_id (nullable)

- `TaskTemplate`
  - id
  - household_id
  - name
  - default_title
  - default_category
  - default_points
  - default_priority
  - default_due_offset_days (nullable)
  - note

- `PointTransaction`
  - id
  - user_id
  - household_id
  - type (earn / spend / adjust)
  - points
  - related_task_id (nullable)
  - related_reward_id (nullable)
  - description
  - created_at

- `RewardTemplate`（ポイント用途テンプレート）
  - id
  - household_id
  - name
  - required_points
  - description
  - is_active

- `RewardUse`（ポイント使用申請 / 実績）
  - id
  - user_id
  - reward_template_id
  - status (requested / approved / rejected / canceled)
  - points
  - created_at
  - approved_by (nullable)
  - approved_at (nullable)

---

## 7. 画面構成（MVP）

1. ログイン画面
2. ダッシュボード
   - 自分のポイント残高
   - 受注中タスク / 発注中タスクのサマリ
3. タスク一覧画面
   - 絞り込み（ステータス、カテゴリ、期日 etc.）
   - 「受注」ボタン
4. タスク詳細画面
   - 発注内容（発注書イメージ）
   - 受注・状態変更ボタン（権限に応じて）
5. タスク新規作成画面
   - テンプレート選択
   - 手動入力
6. タスクテンプレート一覧 / 編集画面
7. ポイント履歴画面（自分 / 全体）
8. ポイント用途（Reward）一覧 / 編集画面
9. ポイント用途申請画面
10. ポイント用途承認画面（管理者／パートナー用）

---

## 8. 技術方針（暫定）

※ユーザの好みで差し替え前提の叩き台。

- フロントエンド：シンプルなサーバーサイドレンダリング or 軽量 SPA
  - 選択肢：React / Vue / Svelte / server-side HTML + htmx 等
- バックエンド：
  - REST API ベース
  - 言語候補：
    - Rust（Actix Web / Axum）
    - Python（FastAPI）
    - Go（Echo / Gin）
- DB：
  - PostgreSQL or SQLite（ローカル運用なら SQLite 一択でも良い）
- 認証：
  - セッション Cookie ベース（家庭内利用のためシンプル案）

---

## 9. 開発フェーズ

### フェーズ1: 設計 & 最小 MVP

**スコープ：**

- Household / User / Task / PointTransaction の実装
- ログイン
- タスク発注・受注・完了承認
- ポイント自動付与 & 残高・履歴表示（最低限）
- PC ブラウザで普通に使えるレベルの UI

### フェーズ2: ポイント用途 & テンプレート

**スコープ：**

- TaskTemplate 機能
- RewardTemplate / RewardUse 機能
- ポイント用途申請・承認フロー
- スマホブラウザ向けの UI 調整（レスポンシブ対応）

### フェーズ3: 便利機能・運用改善

**例：**

- 期日が近づいたタスクのハイライト表示
- 過去の実績からポイント自動推定（将来案）
- 家事カテゴリごとの集計ビュー（簡易版）

---

## 10. リスク / 前提条件

### 10.1 前提

- 利用者は 2〜3 名程度の小規模（家庭内）を想定
- 外部公開や大量トラフィックは想定しない
- セキュリティは「家庭内利用」前提だが、最低限のパスワード保護は行う

### 10.2 リスク

- ポイント設計が曖昧だと、運用中に「不公平感」が出て揉める
  - 対策：ポイントルールはアプリ外の「合意事項」として別途文書化
- アプリが複雑になると、家族の誰も使わなくなる
  - 対策：MVP は「タスク管理＋ポイント残高」までに絞る
- 途中で技術選定に迷走する
  - 対策：最初に 1 スタックを固定し、MVP 完成までは変えない

---

## 11. やらないことリスト（当面）

- 外部サービス連携（Google Calendar / LINE Bot / Slack 等）
- 通知機構（メール通知・Push 通知）は後回し
- 多言語対応
- 役職ごとの細かい権限管理（家庭内では「admin / member」程度）

---

## 12. オープンな検討事項

- Q1: 認証方式
  - 完全ローカルの簡易ログインにするか、メール認証を入れるか
- Q2: タスク完了時のポイント計算
  - 常に固定ポイントか、手動調整を許すか
- Q3: ご褒美の承認フロー
  - 自動承認でサクッと使わせるか、誰かの承認を必須にするか
- Q4: UI の複雑さ
  - 「発注書」に寄せすぎると項目が多くなる → MVP では最小限にどこまで削るか

---

## 13. MVP の「完了条件」

- ブラウザからログインできる
- 家事タスクを発注 → 受注 → 完了承認まで流せる
- 完了承認時にポイントが付与され、残高と履歴に反映されている
- ポイント用途を 1 つ以上登録し、ポイント消費ができる
- スマホブラウザからも最低限操作可能

